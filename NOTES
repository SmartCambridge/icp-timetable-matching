Import the timetable for a particular day (encoded in the source,
currently 2017-10-27):

'''PYTHONPATH=../operating_profile/ ./timetable_journey_extractor.py
../TNDS_bus_data/sections/ | pgloader timetable_journeys.load'''

(script currently extracts EA+EM+SE regions only)

Load siri-vm.json data for 2017-10-27:

'''./sirivm_journey_extractor.py
../siri/sirivm_json/data_bin/2017/10/27/ | pgloader
sirivm_journeys.load'''

Looking at data for Friday 27 October 2017

Using TNDS data for EA+EM+SE Extracted 113574 timetabled
journeys.

The timetable includes 2097 different journeys with duplicate
departure time and origin. And 564 with duplicate departure time,
origin and destination.

Many of these look as if they may be actually duplicated journeys,
either as part of the same Service/Line (and so TNDS file), or split
across Service/Lines (files).

6199 distinct SIRI VM journeys based on departure time, origin and
destination.

Joining SIRI journeys on Timetable journeys by departure time,
origin and destination gives 6202 rows, of which 5758 (93%) matched and
444 (7%) didn't.

6199 journeys of which 444 didn't match leaves 5755 that did. 5758
matched rows for 5755 journeys means we got three extra records as a
result of duplication. In this case this was as a result of three
records each of which were duplicated once.

Investigating the ones that didn't match:

* Three journeys on SCCM/A|The Busway from St Ives Bus Station to
Somersham 17:30, 18:21 and 18:46. Exist in the timetable, but with a
different destination stop.
* Four journeys on SCCM/5|City from Bar Hill to Drummer Street 21:43,
22:43, 19:43, 20:43. 20:43. Exist in the timetable, but with a
different destination stop (0500CCITY484 Stop D3, not 0500CCITY490
Stop E4)
* One journey on SCCM/X13 from Drummer St to Haverhill Bus Station
15:50. Not in timetable, but there is a service departing 15:40.
* 11 (all) journeys SCCM/Tour. Service not in timetable.
* 10 (all) journeys on WP/75 between Orwell/Wrestlingworth and City
Centre. All in timetable but a) with different City Centre stop
(0500CCITY121 Drummer Street Bay 5 not 0500CCITY490 Emmanuel Street E4),
and b) slightly different departure times for the journeys into
Cambridge.

Joining SIRI journeys on Timetable journeys by departure time,
origin (but NOT and destination) gives 6331 rows, of which 6122 (97%)
matched and 209 (3%) didn't.

6199 journeys of which 209 didn't match leaves 5990 that did. 6122
matched rows for 5990 journeys means we got 132 extra records as a
result of duplication. In this case this was as a result of three
records each of which were duplicated once.

Observed that Operator and Line in the SIRI data don't really match
Operator and Line in the  TNDS timetable data. The SIRI ones, while
apparently based on the TNDS ones, look to be largely made up.

Also observed that TNDS line name isn't unique - e.g. '1|City' used by
both SCCM and SCPB. Worst offender is '1' which is used by 34 different
operators.